name: Eliminar reportes DEV

on:
  workflow_dispatch: # Ejecuci√≥n manual

jobs:
  cleanup-dev:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout gh-pages branch
        uses: actions/checkout@v4
        with:
          ref: gh-pages

      - name: Remove DEV directories
        run: |
          # Lista de rutas actualizadas a 'dev'
          paths=(
            "ciudad/desktop/dev"
            "ciudad/webmobile/dev"
            "eldoce/desktop/dev"
            "eldoce/webmobile/dev"
            "eltrece/desktop/dev"
            "eltrece/webmobile/dev"
            "tnpt1/desktop/dev"
            "tnpt1/webmobile/dev"
            "tnpt2/desktop/dev"
            "tnpt2/webmobile/dev"
            "tnpt3/desktop/dev"
            "tnpt3/webmobile/dev"
          )

          for path in "${paths[@]}"; do
            if [ -d "$path" ]; then
              echo "Limpiando: $path"
              rm -rf "$path"/*
            else
              echo "La ruta $path no existe, omitiendo..."
            fi
          done

      - name: Commit and Push changes
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          
          git add .
          
          if git diff --staged --quiet; then
            echo "No se encontraron archivos dev para borrar."
          else
            git commit -m "Automated cleanup: Removed dev files from gh-pages"
            git push origin gh-pages
          fi
